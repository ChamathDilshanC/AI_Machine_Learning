<!DOCTYPE html>
<html lang="si">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vertex AI Deployment WITHOUT Docker - Sinhala Guide</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            overflow: hidden;
        }

        header {
            background: linear-gradient(135deg, #00b09b 0%, #96c93d 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        header p {
            font-size: 1.2em;
            opacity: 0.95;
        }

        .content {
            padding: 40px;
        }

        .method-card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 30px;
            margin-bottom: 30px;
            border-left: 5px solid #00b09b;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .method-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
        }

        .method-number {
            background: linear-gradient(135deg, #00b09b, #96c93d);
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
            font-weight: bold;
            margin-right: 15px;
        }

        .method-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }

        .method-header h2 {
            color: #00b09b;
            font-size: 1.8em;
        }

        .difficulty {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: bold;
            margin-left: 15px;
        }

        .easy {
            background: #d4edda;
            color: #155724;
        }

        .medium {
            background: #fff3cd;
            color: #856404;
        }

        .advanced {
            background: #f8d7da;
            color: #721c24;
        }

        .code-block {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            line-height: 1.6;
        }

        .keyword {
            color: #569cd6;
        }

        .string {
            color: #ce9178;
        }

        .comment {
            color: #6a9955;
        }

        .function {
            color: #dcdcaa;
        }

        .info {
            background: #d1ecf1;
            border-left: 5px solid #17a2b8;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }

        .warning {
            background: #fff3cd;
            border-left: 5px solid #ffc107;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }

        .success {
            background: #d4edda;
            border-left: 5px solid #28a745;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }

        .pros-cons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        .pros, .cons {
            padding: 20px;
            border-radius: 8px;
        }

        .pros {
            background: #d4edda;
            border-left: 4px solid #28a745;
        }

        .cons {
            background: #f8d7da;
            border-left: 4px solid #dc3545;
        }

        .pros h4, .cons h4 {
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        .file-structure {
            background: #f8f9fa;
            border: 2px dashed #00b09b;
            padding: 20px;
            margin: 15px 0;
            border-radius: 8px;
            font-family: monospace;
            white-space: pre;
        }

        .step {
            background: white;
            padding: 20px;
            margin: 15px 0;
            border-radius: 8px;
            border-left: 3px solid #96c93d;
        }

        .step h3 {
            color: #00b09b;
            margin-bottom: 10px;
        }

        ul, ol {
            margin-left: 30px;
            margin-top: 10px;
        }

        li {
            margin-bottom: 10px;
        }

        footer {
            background: linear-gradient(135deg, #00b09b, #96c93d);
            color: white;
            text-align: center;
            padding: 30px;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .comparison-table th {
            background: linear-gradient(135deg, #00b09b, #96c93d);
            color: white;
            padding: 15px;
            text-align: left;
        }

        .comparison-table td {
            padding: 15px;
            border-bottom: 1px solid #ddd;
        }

        .comparison-table tr:hover {
            background: #f5f5f5;
        }

        @media (max-width: 768px) {
            .pros-cons {
                grid-template-columns: 1fr;
            }
            
            header h1 {
                font-size: 1.8em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üöÄ Docker ‡∂±‡∑ê‡∂≠‡∑í‡∑Ä Vertex AI Deployment</h1>
            <p>3 Simple Methods - Joblib Model Deploy ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</p>
        </header>

        <div class="content">
            <!-- Comparison Table -->
            <div class="method-card">
                <h2 style="color: #00b09b; text-align: center; margin-bottom: 30px;">
                    üìä Method Comparison - ‡∂ö‡∑ú‡∂∫‡∑í ‡∂ë‡∂ö ‡∑Ñ‡∑ú‡∂≥‡∂Ø?
                </h2>
                
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>Method</th>
                            <th>Difficulty</th>
                            <th>Setup Time</th>
                            <th>Best For</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Method 1: Pre-built Container</strong></td>
                            <td><span class="difficulty easy">‚≠ê Easy</span></td>
                            <td>5-10 minutes</td>
                            <td>Sklearn models, Quick start</td>
                        </tr>
                        <tr>
                            <td><strong>Method 2: Cloud Functions</strong></td>
                            <td><span class="difficulty easy">‚≠ê Easy</span></td>
                            <td>10-15 minutes</td>
                            <td>Simple APIs, Low traffic</td>
                        </tr>
                        <tr>
                            <td><strong>Method 3: AI Platform (Legacy)</strong></td>
                            <td><span class="difficulty medium">‚≠ê‚≠ê Medium</span></td>
                            <td>15-20 minutes</td>
                            <td>TensorFlow/Keras models</td>
                        </tr>
                    </tbody>
                </table>

                <div class="info">
                    <strong>üéØ Recommendation:</strong> Sklearn model ‡∂±‡∂∏‡∑ä Method 1 ‡∂∑‡∑è‡∑Ä‡∑í‡∂≠‡∑è ‡∂ö‡∂ª‡∂±‡∑ä‡∂± - ‡∑Ñ‡∂ª‡∑í‡∂∏ easy!
                </div>
            </div>

            <!-- METHOD 1: Pre-built Container -->
            <div class="method-card">
                <div class="method-header">
                    <span class="method-number">1</span>
                    <div>
                        <h2>Pre-built Container ‡∂∑‡∑è‡∑Ä‡∑í‡∂≠‡∑è ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</h2>
                        <span class="difficulty easy">‚≠ê EASIEST METHOD</span>
                    </div>
                </div>

                <p style="font-size: 1.1em; margin-bottom: 20px;">
                    Docker install ‡∂ö‡∂ª‡∂±‡∑ä‡∂± ‡∂Ö‡∑Ä‡∑Å‡∑ä‚Äç‡∂∫ ‡∂±‡∑ê‡∑Ñ‡∑ê! Google ‡∂ú‡∑ö pre-built sklearn container ‡∂ë‡∂ö ‡∂∑‡∑è‡∑Ä‡∑í‡∂≠‡∑è ‡∂ö‡∂ª‡∂±‡∑ä‡∂±.
                </p>

                <div class="pros-cons">
                    <div class="pros">
                        <h4>‚úÖ Advantages</h4>
                        <ul>
                            <li>Docker install ‡∂ö‡∂ª‡∂±‡∑ä‡∂± ‡∂ï‡∂±‡∑ö ‡∂±‡∑ê‡∑Ñ‡∑ê</li>
                            <li>‡∑Ñ‡∂ª‡∑í‡∂∏ ‡∑É‡∂ª‡∂Ω ‡∑É‡∑Ñ ‡∑Ä‡∑ö‡∂ú‡∑Ä‡∂≠‡∑ä</li>
                            <li>Sklearn ‡∑É‡∂≥‡∑Ñ‡∑è ‡∑Ñ‡∑ú‡∂≥‡∂∏ option</li>
                            <li>Google maintain ‡∂ö‡∂ª‡∂±‡∑Ä‡∑è</li>
                        </ul>
                    </div>
                    <div class="cons">
                        <h4>‚ùå Limitations</h4>
                        <ul>
                            <li>Sklearn models ‡∑Ä‡∂Ω‡∂ß ‡∑Ä‡∑í‡∂≠‡∂ª‡∂∫‡∑í</li>
                            <li>Custom preprocessing ‡∑É‡∑ì‡∂∏‡∑í‡∂≠</li>
                            <li>Additional libraries install ‡∂ö‡∂ª‡∂±‡∑ä‡∂± ‡∂Ö‡∂∏‡∑è‡∂ª‡∑î</li>
                        </ul>
                    </div>
                </div>

                <!-- Steps -->
                <div class="step">
                    <h3>Step 1: Project Structure ‡∑Ñ‡∂Ø‡∂±‡∑ä‡∂±</h3>
                    <div class="file-structure">my-project/
‚îú‚îÄ‚îÄ train.py
‚îú‚îÄ‚îÄ model.joblib
‚îî‚îÄ‚îÄ deploy.py</div>
                </div>

                <div class="step">
                    <h3>Step 2: Model Train ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</h3>
                    <div class="code-block">
<code><span class="comment"># train.py</span>
<span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> load_iris
<span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestClassifier
<span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split
<span class="keyword">import</span> joblib

<span class="comment"># Data load ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</span>
iris = load_iris()
X_train, X_test, y_train, y_test = train_test_split(
    iris.data, iris.target, test_size=<span class="string">0.2</span>
)

<span class="comment"># Model train ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</span>
model = RandomForestClassifier(n_estimators=<span class="string">100</span>)
model.fit(X_train, y_train)

<span class="comment"># Save ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</span>
joblib.dump(model, <span class="string">'model.joblib'</span>)
<span class="function">print</span>(<span class="string">f"Model accuracy: {model.score(X_test, y_test):.2f}"</span>)
<span class="function">print</span>(<span class="string">"Model saved!"</span>)</code>
                    </div>

                    <div class="code-block">
<code><span class="comment"># Run ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</span>
python train.py</code>
                    </div>
                </div>

                <div class="step">
                    <h3>Step 3: GCS Bucket ‡∂ë‡∂ö‡∂ö‡∑ä ‡∑Ñ‡∂Ø‡∂Ω‡∑è Model Upload ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</h3>
                    <div class="code-block">
<code><span class="comment"># Bucket ‡∑Ñ‡∂Ø‡∂±‡∑ä‡∂±</span>
gsutil mb -l us-central1 gs://YOUR-UNIQUE-BUCKET-NAME

<span class="comment"># Model upload ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</span>
gsutil cp model.joblib gs://YOUR-UNIQUE-BUCKET-NAME/model.joblib

<span class="comment"># Verify ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</span>
gsutil ls gs://YOUR-UNIQUE-BUCKET-NAME/</code>
                    </div>
                </div>

                <div class="step">
                    <h3>Step 4: Vertex AI ‡∑Ä‡∂Ω‡∂ß Deploy ‡∂ö‡∂ª‡∂±‡∑ä‡∂± (Python)</h3>
                    <div class="code-block">
<code><span class="comment"># deploy.py</span>
<span class="keyword">from</span> google.cloud <span class="keyword">import</span> aiplatform

<span class="comment"># Initialize ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</span>
aiplatform.init(
    project=<span class="string">'YOUR_PROJECT_ID'</span>,
    location=<span class="string">'us-central1'</span>,
    staging_bucket=<span class="string">'gs://YOUR-UNIQUE-BUCKET-NAME'</span>
)

<span class="comment"># Model upload ‡∂ö‡∂ª‡∂±‡∑ä‡∂± (Pre-built container ‡∂ë‡∂ö ‡∂∑‡∑è‡∑Ä‡∑í‡∂≠‡∑è ‡∂ö‡∂ª‡∂±‡∑Ä‡∑è)</span>
model = aiplatform.Model.upload(
    display_name=<span class="string">'iris-model-prebuilt'</span>,
    artifact_uri=<span class="string">'gs://YOUR-UNIQUE-BUCKET-NAME/'</span>,
    serving_container_image_uri=<span class="string">'us-docker.pkg.dev/vertex-ai/prediction/sklearn-cpu.1-0:latest'</span>,
)

<span class="function">print</span>(<span class="string">f"‚úÖ Model uploaded: {model.resource_name}"</span>)

<span class="comment"># Endpoint ‡∑Ñ‡∂Ø‡∂±‡∑ä‡∂±</span>
endpoint = aiplatform.Endpoint.create(
    display_name=<span class="string">'iris-endpoint-prebuilt'</span>,
)

<span class="function">print</span>(<span class="string">f"‚úÖ Endpoint created: {endpoint.resource_name}"</span>)

<span class="comment"># Deploy ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</span>
model.deploy(
    endpoint=endpoint,
    deployed_model_display_name=<span class="string">'iris-v1'</span>,
    machine_type=<span class="string">'n1-standard-2'</span>,
    min_replica_count=<span class="string">1</span>,
    max_replica_count=<span class="string">1</span>,
)

<span class="function">print</span>(<span class="string">"üéâ Model deployed successfully!"</span>)
<span class="function">print</span>(<span class="string">f"Endpoint: {endpoint.name}"</span>)</code>
                    </div>

                    <div class="code-block">
<code><span class="comment"># Deploy ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</span>
python deploy.py</code>
                    </div>

                    <div class="warning">
                        <strong>‚è∞ ‡∂â‡∑Ä‡∑É‡∂±‡∑ä‡∂±:</strong> Deploy ‡∑Ä‡∑ô‡∂±‡∑ä‡∂± ‡∑Ä‡∑í‡∂±‡∑è‡∂©‡∑í 10-15‡∂ö‡∑ä ‡∑Ä‡∑í‡∂≠‡∂ª ‡∂∫‡∂±‡∑ä‡∂± ‡∂¥‡∑î‡∑Ö‡∑î‡∑Ä‡∂±‡∑ä.
                    </div>
                </div>

                <div class="step">
                    <h3>Step 5: Test ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</h3>
                    <div class="code-block">
<code><span class="comment"># test.py</span>
<span class="keyword">from</span> google.cloud <span class="keyword">import</span> aiplatform

aiplatform.init(project=<span class="string">'YOUR_PROJECT_ID'</span>, location=<span class="string">'us-central1'</span>)

<span class="comment"># Endpoint ‡∂ë‡∂ö get ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</span>
endpoint = aiplatform.Endpoint.list(
    filter=<span class="string">'display_name="iris-endpoint-prebuilt"'</span>
)[<span class="string">0</span>]

<span class="comment"># Test data</span>
test_data = [[<span class="string">5.1</span>, <span class="string">3.5</span>, <span class="string">1.4</span>, <span class="string">0.2</span>]]

<span class="comment"># Predict ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</span>
prediction = endpoint.predict(instances=test_data)
<span class="function">print</span>(<span class="string">f"Prediction: {prediction.predictions}"</span>)</code>
                    </div>
                </div>

                <div class="success">
                    <strong>üéâ ‡∑Ñ‡∂ª‡∑í!</strong> ‡∂î‡∂∂‡∑ö model ‡∂ë‡∂ö ‡∂Ø‡∑ê‡∂±‡∑ä live! Docker ‡∂±‡∑ê‡∂≠‡∑í‡∑Ä‡∂∏!
                </div>
            </div>

            <!-- METHOD 2: Cloud Functions -->
            <div class="method-card">
                <div class="method-header">
                    <span class="method-number">2</span>
                    <div>
                        <h2>Cloud Functions ‡∂∑‡∑è‡∑Ä‡∑í‡∂≠‡∑è ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</h2>
                        <span class="difficulty easy">‚≠ê SIMPLE & CHEAP</span>
                    </div>
                </div>

                <p style="font-size: 1.1em; margin-bottom: 20px;">
                    Simple REST API ‡∂ë‡∂ö‡∂ö‡∑ä ‡∑Ä‡∑í‡∂Ø‡∑í‡∂∫‡∂ß deploy ‡∂ö‡∂ª‡∂±‡∑ä‡∂±. Low traffic ‡∑É‡∂≥‡∑Ñ‡∑è ‡∑Ñ‡∑ú‡∂≥‡∂∫‡∑í.
                </p>

                <div class="pros-cons">
                    <div class="pros">
                        <h4>‚úÖ Advantages</h4>
                        <ul>
                            <li>‡∑Ñ‡∂ª‡∑í‡∂∏ cheap (pay per request)</li>
                            <li>Auto-scaling</li>
                            <li>‡∑É‡∂ª‡∂Ω setup</li>
                            <li>‡∂ö‡∑í‡∑É‡∑í‡∂∏ infrastructure manage ‡∂ö‡∂ª‡∂±‡∑ä‡∂± ‡∂ï‡∂±‡∑ö ‡∂±‡∑ê‡∑Ñ‡∑ê</li>
                        </ul>
                    </div>
                    <div class="cons">
                        <h4>‚ùå Limitations</h4>
                        <ul>
                            <li>Cold start latency</li>
                            <li>Max 9 minutes execution time</li>
                            <li>Max 8GB memory</li>
                            <li>High traffic ‡∑É‡∂≥‡∑Ñ‡∑è ‡∂Ö‡∂±‡∑î‡∂ö‡∑ñ‡∂Ω ‡∂±‡∑ê‡∑Ñ‡∑ê</li>
                        </ul>
                    </div>
                </div>

                <div class="step">
                    <h3>Step 1: Project Structure</h3>
                    <div class="file-structure">cloud-function-ml/
‚îú‚îÄ‚îÄ main.py
‚îú‚îÄ‚îÄ requirements.txt
‚îî‚îÄ‚îÄ model.joblib</div>
                </div>

                <div class="step">
                    <h3>Step 2: main.py - Function Code</h3>
                    <div class="code-block">
<code><span class="comment"># main.py</span>
<span class="keyword">import</span> joblib
<span class="keyword">import</span> numpy <span class="keyword">as</span> np
<span class="keyword">from</span> flask <span class="keyword">import</span> jsonify

<span class="comment"># Model load ‡∂ö‡∂ª‡∂±‡∑ä‡∂± (global scope ‡∂ë‡∂ö‡∑ö)</span>
model = joblib.load(<span class="string">'model.joblib'</span>)

<span class="keyword">def</span> <span class="function">predict</span>(request):
    <span class="string">"""
    HTTP Cloud Function for predictions
    """</span>
    <span class="comment"># CORS headers</span>
    <span class="keyword">if</span> request.method == <span class="string">'OPTIONS'</span>:
        headers = {
            <span class="string">'Access-Control-Allow-Origin'</span>: <span class="string">'*'</span>,
            <span class="string">'Access-Control-Allow-Methods'</span>: <span class="string">'POST'</span>,
            <span class="string">'Access-Control-Allow-Headers'</span>: <span class="string">'Content-Type'</span>,
        }
        <span class="keyword">return</span> (<span class="string">''</span>, <span class="string">204</span>, headers)

    <span class="comment"># Request data get ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</span>
    request_json = request.get_json(silent=<span class="keyword">True</span>)
    
    <span class="keyword">if</span> <span class="keyword">not</span> request_json <span class="keyword">or</span> <span class="string">'instances'</span> <span class="keyword">not in</span> request_json:
        <span class="keyword">return</span> jsonify({<span class="string">'error'</span>: <span class="string">'No instances provided'</span>}), <span class="string">400</span>
    
    <span class="keyword">try</span>:
        <span class="comment"># Prediction ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</span>
        instances = np.array(request_json[<span class="string">'instances'</span>])
        predictions = model.predict(instances)
        
        <span class="comment"># Response ‡∂ë‡∂ö return ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</span>
        response = {
            <span class="string">'predictions'</span>: predictions.tolist()
        }
        
        headers = {<span class="string">'Access-Control-Allow-Origin'</span>: <span class="string">'*'</span>}
        <span class="keyword">return</span> jsonify(response), <span class="string">200</span>, headers
        
    <span class="keyword">except</span> <span class="function">Exception</span> <span class="keyword">as</span> e:
        <span class="keyword">return</span> jsonify({<span class="string">'error'</span>: <span class="function">str</span>(e)}), <span class="string">500</span></code>
                    </div>
                </div>

                <div class="step">
                    <h3>Step 3: requirements.txt</h3>
                    <div class="code-block">
<code>scikit-learn==1.3.0
joblib==1.3.2
numpy==1.24.3
flask==2.3.0</code>
                    </div>
                </div>

                <div class="step">
                    <h3>Step 4: Deploy ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</h3>
                    <div class="code-block">
<code><span class="comment"># Model file ‡∂ë‡∂ö copy ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</span>
cp /path/to/your/model.joblib ./model.joblib

<span class="comment"># Deploy ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</span>
gcloud functions deploy iris-predict \
    --gen2 \
    --runtime=python310 \
    --region=us-central1 \
    --source=. \
    --entry-point=predict \
    --trigger-http \
    --allow-unauthenticated \
    --memory=512MB \
    --timeout=60s

<span class="comment"># Function URL ‡∂ë‡∂ö copy ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</span></code>
                    </div>

                    <div class="info">
                        <strong>üìù Note:</strong> Deploy ‡∂ë‡∂ö‡∑ô‡∂±‡∑ä ‡∂¥‡∑É‡∑ä‡∑É‡∑ö function URL ‡∂ë‡∂ö‡∂ö‡∑ä ‡∂Ø‡∑ô‡∂±‡∑Ä‡∑è. ‡∂ë‡∂ö save ‡∂ö‡∂ª‡∂±‡∑ä‡∂±!
                    </div>
                </div>

                <div class="step">
                    <h3>Step 5: Test ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</h3>
                    <div class="code-block">
<code><span class="comment"># curl ‡∂ë‡∂ö‡∑ô‡∂±‡∑ä test ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</span>
curl -X POST https://REGION-PROJECT_ID.cloudfunctions.net/iris-predict \
  -H <span class="string">"Content-Type: application/json"</span> \
  -d <span class="string">'{"instances": [[5.1, 3.5, 1.4, 0.2]]}'</span>

<span class="comment"># Python ‡∂ë‡∂ö‡∑ô‡∂±‡∑ä test ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</span></code>
                    </div>

                    <div class="code-block">
<code><span class="keyword">import</span> requests
<span class="keyword">import</span> json

url = <span class="string">"https://REGION-PROJECT_ID.cloudfunctions.net/iris-predict"</span>

data = {
    <span class="string">"instances"</span>: [
        [<span class="string">5.1</span>, <span class="string">3.5</span>, <span class="string">1.4</span>, <span class="string">0.2</span>],
        [<span class="string">6.7</span>, <span class="string">3.0</span>, <span class="string">5.2</span>, <span class="string">2.3</span>]
    ]
}

response = requests.post(url, json=data)
<span class="function">print</span>(response.json())</code>
                    </div>
                </div>

                <div class="success">
                    <strong>üöÄ Done!</strong> ‡∂î‡∂∂‡∑ö model ‡∂ë‡∂ö serverless REST API ‡∂ë‡∂ö‡∂ö‡∑ä ‡∑Ä‡∑í‡∂Ø‡∑í‡∂∫‡∂ß run ‡∑Ä‡∑ô‡∂±‡∑Ä‡∑è!
                </div>
            </div>

            <!-- METHOD 3: Cloud Run -->
            <div class="method-card">
                <div class="method-header">
                    <span class="method-number">3</span>
                    <div>
                        <h2>Cloud Run ‡∂∑‡∑è‡∑Ä‡∑í‡∂≠‡∑è ‡∂ö‡∂ª‡∂±‡∑ä‡∂± (Docker ‡∂±‡∑ê‡∂≠‡∑í‡∑Ä)</h2>
                        <span class="difficulty medium">‚≠ê‚≠ê FLEXIBLE</span>
                    </div>
                </div>

                <p style="font-size: 1.1em; margin-bottom: 20px;">
                    Cloud Build ‡∂ë‡∂ö ‡∂∑‡∑è‡∑Ä‡∑í‡∂≠‡∑è ‡∂ö‡∂ª‡∂Ω‡∑è automatic ‡∑Ä‡∂ú‡∑ö container ‡∂ë‡∂ö‡∂ö‡∑ä ‡∑Ñ‡∂Ø‡∂Ω‡∑è deploy ‡∂ö‡∂ª‡∂±‡∑ä‡∂±.
                </p>

                <div class="step">
                    <h3>Step 1: Project Structure</h3>
                    <div class="file-structure">cloudrun-ml/
‚îú‚îÄ‚îÄ app.py
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ model.joblib
‚îî‚îÄ‚îÄ Procfile</div>
                </div>

                <div class="step">
                    <h3>Step 2: app.py - Flask API</h3>
                    <div class="code-block">
<code><span class="comment"># app.py</span>
<span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, jsonify
<span class="keyword">import</span> joblib
<span class="keyword">import</span> numpy <span class="keyword">as</span> np
<span class="keyword">import</span> os

app = Flask(__name__)

<span class="comment"># Model load ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</span>
model = joblib.load(<span class="string">'model.joblib'</span>)

<span class="decorator">@app.route</span>(<span class="string">'/predict'</span>, methods=[<span class="string">'POST'</span>])
<span class="keyword">def</span> <span class="function">predict</span>():
    <span class="keyword">try</span>:
        data = request.get_json()
        instances = np.array(data[<span class="string">'instances'</span>])
        predictions = model.predict(instances)
        
        <span class="keyword">return</span> jsonify({
            <span class="string">'predictions'</span>: predictions.tolist()
        })
    <span class="keyword">except</span> <span class="function">Exception</span> <span class="keyword">as</span> e:
        <span class="keyword">return</span> jsonify({<span class="string">'error'</span>: <span class="function">str</span>(e)}), <span class="string">500</span>

<span class="decorator">@app.route</span>(<span class="string">'/health'</span>, methods=[<span class="string">'GET'</span>])
<span class="keyword">def</span> <span class="function">health</span>():
    <span class="keyword">return</span> jsonify({<span class="string">'status'</span>: <span class="string">'healthy'</span>})

<span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:
    port = <span class="function">int</span>(os.environ.get(<span class="string">'PORT'</span>, <span class="string">8080</span>))
    app.run(host=<span class="string">'0.0.0.0'</span>, port=port)</code>
                    </div>
                </div>

                <div class="step">
                    <h3>Step 3: requirements.txt</h3>
                    <div class="code-block">
<code>Flask==2.3.0
gunicorn==21.2.0
scikit-learn==1.3.0
joblib==1.3.2
numpy==1.24.3</code>
                    </div>
                </div>

                <div class="step">
                    <h3>Step 4: Procfile (Optional)</h3>
                    <div class="code-block">
<code>web: gunicorn --bind :$PORT app:app</code>
                    </div>
                </div>

                <div class="step">
                    <h3>Step 5: Deploy ‡∂ö‡∂ª‡∂±‡∑ä‡∂± (Cloud Build ‡∂∑‡∑è‡∑Ä‡∑í‡∂≠‡∑è ‡∂ö‡∂ª‡∂Ω‡∑è)</h3>
                    <div class="code-block">
<code><span class="comment"># Cloud Build ‡∂ë‡∂ö automatic ‡∑Ä‡∂ú‡∑ö Docker image ‡∂ë‡∂ö‡∂ö‡∑ä ‡∑Ñ‡∂Ø‡∂±‡∑Ä‡∑è</span>
gcloud run deploy iris-api \
    --source . \
    --region us-central1 \
    --platform managed \
    --allow-unauthenticated \
    --memory 512Mi \
    --cpu 1

<span class="comment"># Service URL ‡∂ë‡∂ö copy ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</span></code>
                    </div>

                    <div class="info">
                        <strong>‚ú® Magic:</strong> Cloud Build automatically Dockerfile ‡∂ë‡∂ö‡∂ö‡∑ä ‡∑Ñ‡∂Ø‡∂Ω‡∑è container ‡∂ë‡∂ö build ‡∂ö‡∂ª‡∂±‡∑Ä‡∑è!
                    </div>
                </div>

                <div class="step">
                    <h3>Step 6: Test ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</h3>
                    <div class="code-block">
<code><span class="comment"># Test ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</span>
curl -X POST https://iris-api-xxx-uc.a.run.app/predict \
  -H <span class="string">"Content-Type: application/json"</span> \
  -d <span class="string">'{"instances": [[5.1, 3.5, 1.4, 0.2]]}'</span></code>
                    </div>
                </div>
            </div>

            <!-- Quick Comparison -->
            <div class="method-card">
                <h2 style="color: #00b09b; margin-bottom: 20px;">‚ö° Quick Decision Guide</h2>

                <div class="step">
                    <h3>Sklearn Model + Simple Deployment = Method 1 (Pre-built)</h3>
                    <p>‚úÖ Docker ‡∂±‡∑ê‡∑Ñ‡∑ê, ‡∂â‡∂ö‡∑ä‡∂∏‡∂±‡∑í‡∂±‡∑ä deploy ‡∑Ä‡∑ô‡∂±‡∑Ä‡∑è, production-ready</p>
                </div>

                <div class="step">
                    <h3>Low Traffic + Cost Conscious = Method 2 (Cloud Functions)</h3>
                    <p>‚úÖ ‡∑Ñ‡∂ª‡∑í‡∂∏ cheap, serverless, auto-scaling</p>
                </div>

                <div class="step">
                    <h3>High Traffic + Custom Logic = Method 3 (Cloud Run)</h3>
                    <p>‚úÖ Flexible, scalable, moderate cost</p>
                </div>
            </div>

            <!-- Complete Example -->
            <div class="method-card">
                <h2 style="color: #00b09b; margin-bottom: 20px;">üéØ ‡∑É‡∂∏‡∑ä‡∂¥‡∑ñ‡∂ª‡∑ä‡∂´ Example - Method 1</h2>

                <div class="info">
                    <strong>‡∂∏‡∑ö‡∂ö ‡∂Ö‡∂±‡∑î‡∂ú‡∂∏‡∂±‡∂∫ ‡∂ö‡∂ª‡∂±‡∑ä‡∂± ‡∂â‡∂ö‡∑ä‡∂∏‡∂±‡∑ä deployment ‡∂ë‡∂ö‡∂ö‡∂ß!</strong>
                </div>

                <div class="code-block">
<code><span class="comment"># 1. Model train ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</span>
python train.py

<span class="comment"># 2. Bucket ‡∑Ñ‡∂Ø‡∂±‡∑ä‡∂±</span>
gsutil mb -l us-central1 gs://my-ml-bucket-123

<span class="comment"># 3. Model upload ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</span>
gsutil cp model.joblib gs://my-ml-bucket-123/

<span class="comment"># 4. Python script ‡∂ë‡∂ö‡∑ô‡∂±‡∑ä deploy ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</span>
python deploy.py

<span class="comment"># 5. Test ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</span>
python test.py</code>
                </div>

                <div class="success">
                    <strong>‚è±Ô∏è Total time:</strong> 10-15 minutes (Docker ‡∂±‡∑ê‡∂≠‡∑í‡∑Ä!)
                </div>
            </div>

            <!-- Troubleshooting -->
            <div class="method-card">
                <h2 style="color: #00b09b; margin-bottom: 20px;">üîß Common Issues</h2>

                <div class="step">
                    <h3>Issue 1: Permission Denied</h3>
                    <div class="code-block">
<code><span class="comment"># Solution: APIs enable ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</span>
gcloud services enable aiplatform.googleapis.com
gcloud services enable cloudfunctions.googleapis.com
gcloud services enable run.googleapis.com</code>
                    </div>
                </div>

                <div class="step">
                    <h3>Issue 2: Model Not Loading</h3>
                    <div class="warning">
                        <ul>
                            <li>Sklearn version ‡∂ë‡∂ö match ‡∑Ä‡∑ô‡∂±‡∑Ä‡∑è ‡∂Ø ‡∂∂‡∂Ω‡∂±‡∑ä‡∂±</li>
                            <li>Model file path ‡∂ë‡∂ö correct ‡∂Ø ‡∂∂‡∂Ω‡∂±‡∑ä‡∂±</li>
                            <li>GCS bucket permissions check ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</li>
                        </ul>
                    </div>
                </div>

                <div class="step">
                    <h3>Issue 3: Cloud Function Timeout</h3>
                    <div class="code-block">
<code><span class="comment"># Timeout ‡∂ë‡∂ö ‡∑Ä‡∑ê‡∂©‡∑í ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</span>
--timeout=300s</code>
                    </div>
                </div>
            </div>

            <!-- Pricing -->
            <div class="method-card">
                <h2 style="color: #00b09b; margin-bottom: 20px;">üí∞ Cost Comparison</h2>

                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>Method</th>
                            <th>Cost (Monthly)</th>
                            <th>Details</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Pre-built Container</td>
                            <td>$50-100</td>
                            <td>Always running (min 1 replica)</td>
                        </tr>
                        <tr>
                            <td>Cloud Functions</td>
                            <td>$5-20</td>
                            <td>Pay per request (good for low traffic)</td>
                        </tr>
                        <tr>
                            <td>Cloud Run</td>
                            <td>$10-50</td>
                            <td>Pay per use (scales to zero)</td>
                        </tr>
                    </tbody>
                </table>

                <div class="info">
                    <strong>üí° Tip:</strong> Testing ‡∑É‡∂≥‡∑Ñ‡∑è Cloud Functions ‡∂∑‡∑è‡∑Ä‡∑í‡∂≠‡∑è ‡∂ö‡∂ª‡∂±‡∑ä‡∂±, production ‡∑É‡∂≥‡∑Ñ‡∑è Pre-built Container ‡∂∑‡∑è‡∑Ä‡∑í‡∂≠‡∑è ‡∂ö‡∂ª‡∂±‡∑ä‡∂±.
                </div>
            </div>

        </div>

        <footer>
            <h2>üéâ ‡∑É‡∑è‡∂ª‡∑ä‡∂Æ‡∂ö‡∂∫‡∑í! Docker ‡∂±‡∑ê‡∂≠‡∑í‡∑Ä Deploy ‡∂ö‡∑Ö‡∑è!</h2>
            <p>‡∂ö‡∑í‡∑É‡∑í‡∂∏ Method ‡∂ë‡∂ö‡∂ö problem ‡∂ë‡∂ö‡∂ö‡∑ä ‡∂á‡∂≠‡∑ä‡∂±‡∂∏‡∑ä ‡∂Ö‡∑Ñ‡∂±‡∑ä‡∂±. ‡∂∏‡∂∏ help ‡∂ö‡∂ª‡∂±‡∑ä‡∂±‡∂∏‡∑ä! üí™</p>
            <p style="margin-top: 20px;">¬© 2026 - GCP ML Deployment Guide (No Docker)</p>
        </footer>
    </div>
</body>
</html>